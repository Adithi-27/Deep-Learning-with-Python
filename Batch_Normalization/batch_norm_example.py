# -*- coding: utf-8 -*-
"""batch-norm-example.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1jsWn2qEFXIl7Y9w6_UYh__w8QFVSVZ1m
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv('/content/concertriccir2.csv')

df.head()

df = df.rename(columns={"7.003345706103683010e-01": 'X', "-2.470675778972781789e-01":'y', "0.000000000000000000e+00":'class'})

plt.scatter(df['X'],df['y'],c=df['class'])

X = df.iloc[:,0:2].values
y = df.iloc[:,-1].values

import tensorflow
from tensorflow import keras
from keras import Sequential
from keras.layers import Dense
from tensorflow.keras.layers import BatchNormalization

model = Sequential()

model.add(Dense(2,activation='relu',input_dim=2))
model.add(Dense(2,activation='relu'))
model.add(Dense(1,activation='sigmoid'))

model.summary()

model.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])

history1 = model.fit(X,y,epochs=200,validation_split=0.2)

model = Sequential()

model.add(Dense(3,activation='relu',input_dim=2))
model.add(BatchNormalization())
model.add(Dense(2,activation='relu'))
model.add(BatchNormalization())
model.add(Dense(1,activation='sigmoid'))

model.summary()

model.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])

history2 = model.fit(X,y,epochs=200,validation_split=0.2)

plt.plot(history1.history['val_accuracy'],color='black')
plt.plot(history2.history['val_accuracy'],color='green')